Add test case for W [KYVu83] line 5.1
Add test case for W [KYVu83] line 5.2
Improve performance [JEGYRV] line 6.1
